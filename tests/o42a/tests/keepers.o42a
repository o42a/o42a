~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Tests
Copyright (C) 2012 Ruslan Lopatin

This file is part of o42a.

o42a is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

o42a is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Use namespace 'Console'
Use namespace 'Test'

Keepers := test
===============

Name = "Keeper Tests"

Print error [name] nl
Run tests

Keep constant := test (
  Name = "Keep constant"
  Print error '  ' [name] nl
  
  Kept := //1
  Assert [kept == 1] 'Wrong initial constant keeper value'
  Assert [kept == 1] 'Wrong subsequent constant keeper value' 
)

Keep variable target := test (
  Name = "Keep variable target"
  Print error '  ' [name] nl
  
  Var := ``1
  Kept := //var
  {
    Assert [kept == 1] 'Wrong variable value kept initially'
    Var = 2
    Assert [kept == 1] 'Kept variable value updated'
  }
)

Keep string := test (
  Name = "Keep string"
  Print error '  ' [name] nl
  
  Kept := //rt-string 'Kept'
  Assert [kept == "Kept"] 'Wrong string kept'
)

Keep link := test (
  Name = "Keep link"
  Print error '  ' [name] nl
  
  Lnk := `rt-string 'Kept'
  Kept := //Lnk`
  Assert [kept == "Kept"] 'Wrong link kept'
)
